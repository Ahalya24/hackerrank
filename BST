SELECT a.N , 
CASE WHEN P IS NULL THEN 'Root'
WHEN NOT EXISTS (SELECT P FROM BST b WHERE a.N=b.P) THEN 'Leaf'
ELSE 'Inner' END
FROM BST a
ORDER BY N;
